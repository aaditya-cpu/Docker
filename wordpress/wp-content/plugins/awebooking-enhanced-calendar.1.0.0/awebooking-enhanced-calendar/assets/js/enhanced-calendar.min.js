!function(){"use strict";var t=function(){function e(t,a){for(var i=0;i<a.length;i++){var e=a[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),a=function(o){var e={show_month:1};function s(t){return t=t instanceof jQuery?t[0]:t,awebooking.utils.dates.format(t.dateObj,"Y-m-d")}var r=function(){function n(t,a,i){!function(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this,n),this.room=a,this.element=t,this.options=o.extend({},e,i),this.availability=void 0,this._xhrRequest=void 0}return t(n,[{key:"init",value:function(){flatpickr(this.element,{mode:"single",inline:!0,static:!0,showMonths:this.options.show_months||1,minDate:"today",maxDate:this.getMaxDate(),onReady:this._getAvailability.bind(this),onMonthChange:this._getAvailability.bind(this),onDayCreate:this._onFlatpickrDayCreate.bind(this)})}},{key:"getMaxDate",value:function(){var t=new Date;return t.setMonth(t.getMonth()+6),t}},{key:"_getAvailability",value:function(t,a,i){var e=this;this._xhrRequest&&this._xhrRequest.abort(),this._xhrRequest=n.fetchAvailability(this.room,i),this._xhrRequest.then(function(t){e._xhrRequest=void 0,e.availability=t,i.redraw()})}},{key:"_onFlatpickrDayCreate",value:function(t,a,i,e){if(this.availability&&!e.classList.contains("disabled")){var n=s(e);if(this.availability.hasOwnProperty(n)){var r=this.availability[n];o(e).addClass(0===r?"unavailable disabled":"available")}}}}]),n}();return r.fetchAvailability=function(t,a){var i={};if(1===a.config.showMonths)i={month:a.currentMonth+1,year:a.currentYear};else{var e=o(a.daysContainer).find(".flatpickr-day");i.start_date=s(e.first()),i.end_date=s(e.last())}return o.ajax({url:awebooking.route("/calendar/availability/"+t),data:i,method:"GET",dataType:"json"})},o(function(){o('[data-init="availability-calendar"]').each(function(t,a){var i=o(a).data("room"),e=o(a).data("settings"),n=new r(a,i,e);n.init(),o(a).data("a-calendar",n)})}),r}(jQuery);awebooking.instances.AvailabilityCalendar=a}();